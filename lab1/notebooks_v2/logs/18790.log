Using GPU(s): 1
index, name, memory.total [MiB], memory.free [MiB]
0, NVIDIA L40S, 46068 MiB, 28921 MiB
1, NVIDIA L40S, 46068 MiB, 45469 MiB
2, NVIDIA L40S, 46068 MiB, 45469 MiB
3, NVIDIA L40S, 46068 MiB, 45469 MiB
==========================================
Starting execution of: 03_f2llm_4B_ft_tweet.ipynb
==========================================
Successfully saved to: entregables/03_f2llm_4B_ft_tweet_out.ipynb
Memory cleaned after successful execution
Memory cleaned
[W226 13:46:24.218799037 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())

==========================================
Starting execution of: 03_modelos_clasicos.ipynb
==========================================
Successfully saved to: entregables/03_modelos_clasicos_out.ipynb
Memory cleaned after successful execution
Memory cleaned
[W226 13:47:48.745267759 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())

==========================================
Starting execution of: 04_f2llm_4B_ft_text_clean.ipynb
==========================================
Successfully saved to: entregables/04_f2llm_4B_ft_text_clean_out.ipynb
Memory cleaned after successful execution
Memory cleaned
[W226 14:10:17.740297803 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())

==========================================
Starting execution of: 05_KaLM_ft_tweet.ipynb
==========================================
Error occurred. Notebook saved to: entregables/05_KaLM_ft_tweet_error.ipynb
Error: An error occurred while executing the following cell:
------------------
tokenizer = AutoTokenizer.from_pretrained(MODEL_NAME)
if tokenizer.pad_token is None:
    tokenizer.pad_token = tokenizer.eos_token

def tokenize(batch):
    encoding = tokenizer(batch[TEXT_COLUMN], truncation=True, padding="max_length", max_length=256)
    return encoding

train_dataset = Dataset.from_pandas(train_df[['id_EXIST', TEXT_COLUMN, 'label']]).map(tokenize, batched=True)
eval_dataset = Dataset.from_pandas(val_df[['id_EXIST', TEXT_COLUMN, 'label']]).map(tokenize, batched=True)
test_dataset = Dataset.from_pandas(test_df[['id_EXIST', TEXT_COLUMN, 'label']]).map(tokenize, batched=True)
------------------


[31m---------------------------------------------------------------------------[39m
[31mHTTPError[39m                                 Traceback (most recent call last)
[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/huggingface_hub/utils/_http.py:402[39m, in [36mhf_raise_for_status[39m[34m(response, endpoint_name)[39m
[32m    401[39m [38;5;28;01mtry[39;00m:
[32m--> [39m[32m402[39m     [43mresponse[49m[43m.[49m[43mraise_for_status[49m[43m([49m[43m)[49m
[32m    403[39m [38;5;28;01mexcept[39;00m HTTPError [38;5;28;01mas[39;00m e:

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/requests/models.py:1026[39m, in [36mResponse.raise_for_status[39m[34m(self)[39m
[32m   1025[39m [38;5;28;01mif[39;00m http_error_msg:
[32m-> [39m[32m1026[39m     [38;5;28;01mraise[39;00m HTTPError(http_error_msg, response=[38;5;28mself[39m)

[31mHTTPError[39m: 404 Client Error: Not Found for url: https://huggingface.co/FernandoLpz/KaLM-ft-cov19en-hs/resolve/main/tokenizer_config.json

The above exception was the direct cause of the following exception:

[31mRepositoryNotFoundError[39m                   Traceback (most recent call last)
[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/transformers/utils/hub.py:479[39m, in [36mcached_files[39m[34m(path_or_repo_id, filenames, cache_dir, force_download, resume_download, proxies, token, revision, local_files_only, subfolder, repo_type, user_agent, _raise_exceptions_for_gated_repo, _raise_exceptions_for_missing_entries, _raise_exceptions_for_connection_errors, _commit_hash, **deprecated_kwargs)[39m
[32m    477[39m [38;5;28;01mif[39;00m [38;5;28mlen[39m(full_filenames) == [32m1[39m:
[32m    478[39m     [38;5;66;03m# This is slightly better for only 1 file[39;00m
[32m--> [39m[32m479[39m     [43mhf_hub_download[49m[43m([49m
[32m    480[39m [43m        [49m[43mpath_or_repo_id[49m[43m,[49m
[32m    481[39m [43m        [49m[43mfilenames[49m[43m[[49m[32;43m0[39;49m[43m][49m[43m,[49m
[32m    482[39m [43m        [49m[43msubfolder[49m[43m=[49m[38;5;28;43;01mNone[39;49;00m[43m [49m[38;5;28;43;01mif[39;49;00m[43m [49m[38;5;28;43mlen[39;49m[43m([49m[43msubfolder[49m[43m)[49m[43m [49m[43m==[49m[43m [49m[32;43m0[39;49m[43m [49m[38;5;28;43;01melse[39;49;00m[43m [49m[43msubfolder[49m[43m,[49m
[32m    483[39m [43m        [49m[43mrepo_type[49m[43m=[49m[43mrepo_type[49m[43m,[49m
[32m    484[39m [43m        [49m[43mrevision[49m[43m=[49m[43mrevision[49m[43m,[49m
[32m    485[39m [43m        [49m[43mcache_dir[49m[43m=[49m[43mcache_dir[49m[43m,[49m
[32m    486[39m [43m        [49m[43muser_agent[49m[43m=[49m[43muser_agent[49m[43m,[49m
[32m    487[39m [43m        [49m[43mforce_download[49m[43m=[49m[43mforce_download[49m[43m,[49m
[32m    488[39m [43m        [49m[43mproxies[49m[43m=[49m[43mproxies[49m[43m,[49m
[32m    489[39m [43m        [49m[43mresume_download[49m[43m=[49m[43mresume_download[49m[43m,[49m
[32m    490[39m [43m        [49m[43mtoken[49m[43m=[49m[43mtoken[49m[43m,[49m
[32m    491[39m [43m        [49m[43mlocal_files_only[49m[43m=[49m[43mlocal_files_only[49m[43m,[49m
[32m    492[39m [43m    [49m[43m)[49m
[32m    493[39m [38;5;28;01melse[39;00m:

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py:114[39m, in [36mvalidate_hf_hub_args.<locals>._inner_fn[39m[34m(*args, **kwargs)[39m
[32m    112[39m     kwargs = smoothly_deprecate_use_auth_token(fn_name=fn.[34m__name__[39m, has_token=has_token, kwargs=kwargs)
[32m--> [39m[32m114[39m [38;5;28;01mreturn[39;00m [43mfn[49m[43m([49m[43m*[49m[43margs[49m[43m,[49m[43m [49m[43m*[49m[43m*[49m[43mkwargs[49m[43m)[49m

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/huggingface_hub/file_download.py:1007[39m, in [36mhf_hub_download[39m[34m(repo_id, filename, subfolder, repo_type, revision, library_name, library_version, cache_dir, local_dir, user_agent, force_download, proxies, etag_timeout, token, local_files_only, headers, endpoint, resume_download, force_filename, local_dir_use_symlinks)[39m
[32m   1006[39m [38;5;28;01melse[39;00m:
[32m-> [39m[32m1007[39m     [38;5;28;01mreturn[39;00m [43m_hf_hub_download_to_cache_dir[49m[43m([49m
[32m   1008[39m [43m        [49m[38;5;66;43;03m# Destination[39;49;00m
[32m   1009[39m [43m        [49m[43mcache_dir[49m[43m=[49m[43mcache_dir[49m[43m,[49m
[32m   1010[39m [43m        [49m[38;5;66;43;03m# File info[39;49;00m
[32m   1011[39m [43m        [49m[43mrepo_id[49m[43m=[49m[43mrepo_id[49m[43m,[49m
[32m   1012[39m [43m        [49m[43mfilename[49m[43m=[49m[43mfilename[49m[43m,[49m
[32m   1013[39m [43m        [49m[43mrepo_type[49m[43m=[49m[43mrepo_type[49m[43m,[49m
[32m   1014[39m [43m        [49m[43mrevision[49m[43m=[49m[43mrevision[49m[43m,[49m
[32m   1015[39m [43m        [49m[38;5;66;43;03m# HTTP info[39;49;00m
[32m   1016[39m [43m        [49m[43mendpoint[49m[43m=[49m[43mendpoint[49m[43m,[49m
[32m   1017[39m [43m        [49m[43metag_timeout[49m[43m=[49m[43metag_timeout[49m[43m,[49m
[32m   1018[39m [43m        [49m[43mheaders[49m[43m=[49m[43mhf_headers[49m[43m,[49m
[32m   1019[39m [43m        [49m[43mproxies[49m[43m=[49m[43mproxies[49m[43m,[49m
[32m   1020[39m [43m        [49m[43mtoken[49m[43m=[49m[43mtoken[49m[43m,[49m
[32m   1021[39m [43m        [49m[38;5;66;43;03m# Additional options[39;49;00m
[32m   1022[39m [43m        [49m[43mlocal_files_only[49m[43m=[49m[43mlocal_files_only[49m[43m,[49m
[32m   1023[39m [43m        [49m[43mforce_download[49m[43m=[49m[43mforce_download[49m[43m,[49m
[32m   1024[39m [43m    [49m[43m)[49m

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/huggingface_hub/file_download.py:1114[39m, in [36m_hf_hub_download_to_cache_dir[39m[34m(cache_dir, repo_id, filename, repo_type, revision, endpoint, etag_timeout, headers, proxies, token, local_files_only, force_download)[39m
[32m   1113[39m     [38;5;66;03m# Otherwise, raise appropriate error[39;00m
[32m-> [39m[32m1114[39m     [43m_raise_on_head_call_error[49m[43m([49m[43mhead_call_error[49m[43m,[49m[43m [49m[43mforce_download[49m[43m,[49m[43m [49m[43mlocal_files_only[49m[43m)[49m
[32m   1116[39m [38;5;66;03m# From now on, etag, commit_hash, url and size are not None.[39;00m

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/huggingface_hub/file_download.py:1655[39m, in [36m_raise_on_head_call_error[39m[34m(head_call_error, force_download, local_files_only)[39m
[32m   1650[39m [38;5;28;01melif[39;00m [38;5;28misinstance[39m(head_call_error, (RepositoryNotFoundError, GatedRepoError)) [38;5;129;01mor[39;00m (
[32m   1651[39m     [38;5;28misinstance[39m(head_call_error, HfHubHTTPError) [38;5;129;01mand[39;00m head_call_error.response.status_code == [32m401[39m
[32m   1652[39m ):
[32m   1653[39m     [38;5;66;03m# Repo not found or gated => let's raise the actual error[39;00m
[32m   1654[39m     [38;5;66;03m# Unauthorized => likely a token issue => let's raise the actual error[39;00m
[32m-> [39m[32m1655[39m     [38;5;28;01mraise[39;00m head_call_error
[32m   1656[39m [38;5;28;01melse[39;00m:
[32m   1657[39m     [38;5;66;03m# Otherwise: most likely a connection issue or Hub downtime => let's warn the user[39;00m

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/huggingface_hub/file_download.py:1543[39m, in [36m_get_metadata_or_catch_error[39m[34m(repo_id, filename, repo_type, revision, endpoint, proxies, etag_timeout, headers, token, local_files_only, relative_filename, storage_folder)[39m
[32m   1542[39m [38;5;28;01mtry[39;00m:
[32m-> [39m[32m1543[39m     metadata = [43mget_hf_file_metadata[49m[43m([49m
[32m   1544[39m [43m        [49m[43murl[49m[43m=[49m[43murl[49m[43m,[49m[43m [49m[43mproxies[49m[43m=[49m[43mproxies[49m[43m,[49m[43m [49m[43mtimeout[49m[43m=[49m[43metag_timeout[49m[43m,[49m[43m [49m[43mheaders[49m[43m=[49m[43mheaders[49m[43m,[49m[43m [49m[43mtoken[49m[43m=[49m[43mtoken[49m[43m,[49m[43m [49m[43mendpoint[49m[43m=[49m[43mendpoint[49m
[32m   1545[39m [43m    [49m[43m)[49m
[32m   1546[39m [38;5;28;01mexcept[39;00m EntryNotFoundError [38;5;28;01mas[39;00m http_error:

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py:114[39m, in [36mvalidate_hf_hub_args.<locals>._inner_fn[39m[34m(*args, **kwargs)[39m
[32m    112[39m     kwargs = smoothly_deprecate_use_auth_token(fn_name=fn.[34m__name__[39m, has_token=has_token, kwargs=kwargs)
[32m--> [39m[32m114[39m [38;5;28;01mreturn[39;00m [43mfn[49m[43m([49m[43m*[49m[43margs[49m[43m,[49m[43m [49m[43m*[49m[43m*[49m[43mkwargs[49m[43m)[49m

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/huggingface_hub/file_download.py:1460[39m, in [36mget_hf_file_metadata[39m[34m(url, token, proxies, timeout, library_name, library_version, user_agent, headers, endpoint)[39m
[32m   1459[39m [38;5;66;03m# Retrieve metadata[39;00m
[32m-> [39m[32m1460[39m r = [43m_request_wrapper[49m[43m([49m
[32m   1461[39m [43m    [49m[43mmethod[49m[43m=[49m[33;43m"[39;49m[33;43mHEAD[39;49m[33;43m"[39;49m[43m,[49m
[32m   1462[39m [43m    [49m[43murl[49m[43m=[49m[43murl[49m[43m,[49m
[32m   1463[39m [43m    [49m[43mheaders[49m[43m=[49m[43mhf_headers[49m[43m,[49m
[32m   1464[39m [43m    [49m[43mallow_redirects[49m[43m=[49m[38;5;28;43;01mFalse[39;49;00m[43m,[49m
[32m   1465[39m [43m    [49m[43mfollow_relative_redirects[49m[43m=[49m[38;5;28;43;01mTrue[39;49;00m[43m,[49m
[32m   1466[39m [43m    [49m[43mproxies[49m[43m=[49m[43mproxies[49m[43m,[49m
[32m   1467[39m [43m    [49m[43mtimeout[49m[43m=[49m[43mtimeout[49m[43m,[49m
[32m   1468[39m [43m[49m[43m)[49m
[32m   1469[39m hf_raise_for_status(r)

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/huggingface_hub/file_download.py:283[39m, in [36m_request_wrapper[39m[34m(method, url, follow_relative_redirects, **params)[39m
[32m    282[39m [38;5;28;01mif[39;00m follow_relative_redirects:
[32m--> [39m[32m283[39m     response = [43m_request_wrapper[49m[43m([49m
[32m    284[39m [43m        [49m[43mmethod[49m[43m=[49m[43mmethod[49m[43m,[49m
[32m    285[39m [43m        [49m[43murl[49m[43m=[49m[43murl[49m[43m,[49m
[32m    286[39m [43m        [49m[43mfollow_relative_redirects[49m[43m=[49m[38;5;28;43;01mFalse[39;49;00m[43m,[49m
[32m    287[39m [43m        [49m[43m*[49m[43m*[49m[43mparams[49m[43m,[49m
[32m    288[39m [43m    [49m[43m)[49m
[32m    290[39m     [38;5;66;03m# If redirection, we redirect only relative paths.[39;00m
[32m    291[39m     [38;5;66;03m# This is useful in case of a renamed repository.[39;00m

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/huggingface_hub/file_download.py:307[39m, in [36m_request_wrapper[39m[34m(method, url, follow_relative_redirects, **params)[39m
[32m    306[39m response = http_backoff(method=method, url=url, **params)
[32m--> [39m[32m307[39m [43mhf_raise_for_status[49m[43m([49m[43mresponse[49m[43m)[49m
[32m    308[39m [38;5;28;01mreturn[39;00m response

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/huggingface_hub/utils/_http.py:452[39m, in [36mhf_raise_for_status[39m[34m(response, endpoint_name)[39m
[32m    443[39m     message = (
[32m    444[39m         [33mf[39m[33m"[39m[38;5;132;01m{[39;00mresponse.status_code[38;5;132;01m}[39;00m[33m Client Error.[39m[33m"[39m
[32m    445[39m         + [33m"[39m[38;5;130;01m\n[39;00m[38;5;130;01m\n[39;00m[33m"[39m
[32m   (...)[39m[32m    450[39m         [33m"[39m[33m https://huggingface.co/docs/huggingface_hub/authentication[39m[33m"[39m
[32m    451[39m     )
[32m--> [39m[32m452[39m     [38;5;28;01mraise[39;00m _format(RepositoryNotFoundError, message, response) [38;5;28;01mfrom[39;00m[38;5;250m [39m[34;01me[39;00m
[32m    454[39m [38;5;28;01melif[39;00m response.status_code == [32m400[39m:

[31mRepositoryNotFoundError[39m: 404 Client Error. (Request ID: Root=1-69a0463f-34444c45605ed8ce04006cbe;d7235437-09b1-4abf-9b75-dd96d28beed3)

Repository Not Found for url: https://huggingface.co/FernandoLpz/KaLM-ft-cov19en-hs/resolve/main/tokenizer_config.json.
Please make sure you specified the correct `repo_id` and `repo_type`.
If you are trying to access a private or gated repo, make sure you are authenticated. For more details, see https://huggingface.co/docs/huggingface_hub/authentication

The above exception was the direct cause of the following exception:

[31mOSError[39m                                   Traceback (most recent call last)
[36mCell[39m[36m [39m[32mIn[4][39m[32m, line 1[39m
[32m----> [39m[32m1[39m tokenizer = [43mAutoTokenizer[49m[43m.[49m[43mfrom_pretrained[49m[43m([49m[43mMODEL_NAME[49m[43m)[49m
[32m      2[39m [38;5;28;01mif[39;00m tokenizer.pad_token [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[32m      3[39m     tokenizer.pad_token = tokenizer.eos_token

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/transformers/models/auto/tokenization_auto.py:1089[39m, in [36mAutoTokenizer.from_pretrained[39m[34m(cls, pretrained_model_name_or_path, *inputs, **kwargs)[39m
[32m   1086[39m     [38;5;28;01mreturn[39;00m tokenizer_class.from_pretrained(pretrained_model_name_or_path, *inputs, **kwargs)
[32m   1088[39m [38;5;66;03m# Next, let's try to use the tokenizer_config file to get the tokenizer class.[39;00m
[32m-> [39m[32m1089[39m tokenizer_config = [43mget_tokenizer_config[49m[43m([49m[43mpretrained_model_name_or_path[49m[43m,[49m[43m [49m[43m*[49m[43m*[49m[43mkwargs[49m[43m)[49m
[32m   1090[39m [38;5;28;01mif[39;00m [33m"[39m[33m_commit_hash[39m[33m"[39m [38;5;129;01min[39;00m tokenizer_config:
[32m   1091[39m     kwargs[[33m"[39m[33m_commit_hash[39m[33m"[39m] = tokenizer_config[[33m"[39m[33m_commit_hash[39m[33m"[39m]

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/transformers/models/auto/tokenization_auto.py:921[39m, in [36mget_tokenizer_config[39m[34m(pretrained_model_name_or_path, cache_dir, force_download, resume_download, proxies, token, revision, local_files_only, subfolder, **kwargs)[39m
[32m    918[39m     token = use_auth_token
[32m    920[39m commit_hash = kwargs.get([33m"[39m[33m_commit_hash[39m[33m"[39m)
[32m--> [39m[32m921[39m resolved_config_file = [43mcached_file[49m[43m([49m
[32m    922[39m [43m    [49m[43mpretrained_model_name_or_path[49m[43m,[49m
[32m    923[39m [43m    [49m[43mTOKENIZER_CONFIG_FILE[49m[43m,[49m
[32m    924[39m [43m    [49m[43mcache_dir[49m[43m=[49m[43mcache_dir[49m[43m,[49m
[32m    925[39m [43m    [49m[43mforce_download[49m[43m=[49m[43mforce_download[49m[43m,[49m
[32m    926[39m [43m    [49m[43mresume_download[49m[43m=[49m[43mresume_download[49m[43m,[49m
[32m    927[39m [43m    [49m[43mproxies[49m[43m=[49m[43mproxies[49m[43m,[49m
[32m    928[39m [43m    [49m[43mtoken[49m[43m=[49m[43mtoken[49m[43m,[49m
[32m    929[39m [43m    [49m[43mrevision[49m[43m=[49m[43mrevision[49m[43m,[49m
[32m    930[39m [43m    [49m[43mlocal_files_only[49m[43m=[49m[43mlocal_files_only[49m[43m,[49m
[32m    931[39m [43m    [49m[43msubfolder[49m[43m=[49m[43msubfolder[49m[43m,[49m
[32m    932[39m [43m    [49m[43m_raise_exceptions_for_gated_repo[49m[43m=[49m[38;5;28;43;01mFalse[39;49;00m[43m,[49m
[32m    933[39m [43m    [49m[43m_raise_exceptions_for_missing_entries[49m[43m=[49m[38;5;28;43;01mFalse[39;49;00m[43m,[49m
[32m    934[39m [43m    [49m[43m_raise_exceptions_for_connection_errors[49m[43m=[49m[38;5;28;43;01mFalse[39;49;00m[43m,[49m
[32m    935[39m [43m    [49m[43m_commit_hash[49m[43m=[49m[43mcommit_hash[49m[43m,[49m
[32m    936[39m [43m[49m[43m)[49m
[32m    937[39m [38;5;28;01mif[39;00m resolved_config_file [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[32m    938[39m     logger.info([33m"[39m[33mCould not locate the tokenizer configuration file, will try to use the model config instead.[39m[33m"[39m)

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/transformers/utils/hub.py:322[39m, in [36mcached_file[39m[34m(path_or_repo_id, filename, **kwargs)[39m
[32m    264[39m [38;5;28;01mdef[39;00m[38;5;250m [39m[34mcached_file[39m(
[32m    265[39m     path_or_repo_id: Union[[38;5;28mstr[39m, os.PathLike],
[32m    266[39m     filename: [38;5;28mstr[39m,
[32m    267[39m     **kwargs,
[32m    268[39m ) -> Optional[[38;5;28mstr[39m]:
[32m    269[39m [38;5;250m    [39m[33;03m"""[39;00m
[32m    270[39m [33;03m    Tries to locate a file in a local folder and repo, downloads and cache it if necessary.[39;00m
[32m    271[39m 
[32m   (...)[39m[32m    320[39m [33;03m    ```[39;00m
[32m    321[39m [33;03m    """[39;00m
[32m--> [39m[32m322[39m     file = [43mcached_files[49m[43m([49m[43mpath_or_repo_id[49m[43m=[49m[43mpath_or_repo_id[49m[43m,[49m[43m [49m[43mfilenames[49m[43m=[49m[43m[[49m[43mfilename[49m[43m][49m[43m,[49m[43m [49m[43m*[49m[43m*[49m[43mkwargs[49m[43m)[49m
[32m    323[39m     file = file[[32m0[39m] [38;5;28;01mif[39;00m file [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m [38;5;28;01melse[39;00m file
[32m    324[39m     [38;5;28;01mreturn[39;00m file

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/transformers/utils/hub.py:511[39m, in [36mcached_files[39m[34m(path_or_repo_id, filenames, cache_dir, force_download, resume_download, proxies, token, revision, local_files_only, subfolder, repo_type, user_agent, _raise_exceptions_for_gated_repo, _raise_exceptions_for_missing_entries, _raise_exceptions_for_connection_errors, _commit_hash, **deprecated_kwargs)[39m
[32m    508[39m [38;5;28;01mexcept[39;00m [38;5;167;01mException[39;00m [38;5;28;01mas[39;00m e:
[32m    509[39m     [38;5;66;03m# We cannot recover from them[39;00m
[32m    510[39m     [38;5;28;01mif[39;00m [38;5;28misinstance[39m(e, RepositoryNotFoundError) [38;5;129;01mand[39;00m [38;5;129;01mnot[39;00m [38;5;28misinstance[39m(e, GatedRepoError):
[32m--> [39m[32m511[39m         [38;5;28;01mraise[39;00m [38;5;167;01mOSError[39;00m(
[32m    512[39m             [33mf[39m[33m"[39m[38;5;132;01m{[39;00mpath_or_repo_id[38;5;132;01m}[39;00m[33m is not a local folder and is not a valid model identifier [39m[33m"[39m
[32m    513[39m             [33m"[39m[33mlisted on [39m[33m'[39m[33mhttps://huggingface.co/models[39m[33m'[39m[38;5;130;01m\n[39;00m[33mIf this is a private repository, make sure to pass a token [39m[33m"[39m
[32m    514[39m             [33m"[39m[33mhaving permission to this repo either by logging in with `hf auth login` or by passing [39m[33m"[39m
[32m    515[39m             [33m"[39m[33m`token=<your_token>`[39m[33m"[39m
[32m    516[39m         ) [38;5;28;01mfrom[39;00m[38;5;250m [39m[34;01me[39;00m
[32m    517[39m     [38;5;28;01melif[39;00m [38;5;28misinstance[39m(e, RevisionNotFoundError):
[32m    518[39m         [38;5;28;01mraise[39;00m [38;5;167;01mOSError[39;00m(
[32m    519[39m             [33mf[39m[33m"[39m[38;5;132;01m{[39;00mrevision[38;5;132;01m}[39;00m[33m is not a valid git identifier (branch name, tag name or commit id) that exists [39m[33m"[39m
[32m    520[39m             [33m"[39m[33mfor this model name. Check the model page at [39m[33m"[39m
[32m    521[39m             [33mf[39m[33m"[39m[33m'[39m[33mhttps://huggingface.co/[39m[38;5;132;01m{[39;00mpath_or_repo_id[38;5;132;01m}[39;00m[33m'[39m[33m for available revisions.[39m[33m"[39m
[32m    522[39m         ) [38;5;28;01mfrom[39;00m[38;5;250m [39m[34;01me[39;00m

[31mOSError[39m: FernandoLpz/KaLM-ft-cov19en-hs is not a local folder and is not a valid model identifier listed on 'https://huggingface.co/models'
If this is a private repository, make sure to pass a token having permission to this repo either by logging in with `hf auth login` or by passing `token=<your_token>`

Memory cleaned
[W226 14:10:27.054171046 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
WARNING: 05_KaLM_ft_tweet.ipynb execution failed, continuing with next notebook...

==========================================
Starting execution of: 06_KaLM_ft_text_clean.ipynb
==========================================
Error occurred. Notebook saved to: entregables/06_KaLM_ft_text_clean_error.ipynb
Error: An error occurred while executing the following cell:
------------------
tokenizer = AutoTokenizer.from_pretrained(MODEL_NAME)
if tokenizer.pad_token is None:
    tokenizer.pad_token = tokenizer.eos_token

def tokenize(batch):
    encoding = tokenizer(batch[TEXT_COLUMN], truncation=True, padding="max_length", max_length=256)
    return encoding

train_dataset = Dataset.from_pandas(train_df[['id_EXIST', TEXT_COLUMN, 'label']]).map(tokenize, batched=True)
eval_dataset = Dataset.from_pandas(val_df[['id_EXIST', TEXT_COLUMN, 'label']]).map(tokenize, batched=True)
test_dataset = Dataset.from_pandas(test_df[['id_EXIST', TEXT_COLUMN, 'label']]).map(tokenize, batched=True)
------------------


[31m---------------------------------------------------------------------------[39m
[31mHTTPError[39m                                 Traceback (most recent call last)
[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/huggingface_hub/utils/_http.py:402[39m, in [36mhf_raise_for_status[39m[34m(response, endpoint_name)[39m
[32m    401[39m [38;5;28;01mtry[39;00m:
[32m--> [39m[32m402[39m     [43mresponse[49m[43m.[49m[43mraise_for_status[49m[43m([49m[43m)[49m
[32m    403[39m [38;5;28;01mexcept[39;00m HTTPError [38;5;28;01mas[39;00m e:

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/requests/models.py:1026[39m, in [36mResponse.raise_for_status[39m[34m(self)[39m
[32m   1025[39m [38;5;28;01mif[39;00m http_error_msg:
[32m-> [39m[32m1026[39m     [38;5;28;01mraise[39;00m HTTPError(http_error_msg, response=[38;5;28mself[39m)

[31mHTTPError[39m: 404 Client Error: Not Found for url: https://huggingface.co/FernandoLpz/KaLM-ft-cov19en-hs/resolve/main/tokenizer_config.json

The above exception was the direct cause of the following exception:

[31mRepositoryNotFoundError[39m                   Traceback (most recent call last)
[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/transformers/utils/hub.py:479[39m, in [36mcached_files[39m[34m(path_or_repo_id, filenames, cache_dir, force_download, resume_download, proxies, token, revision, local_files_only, subfolder, repo_type, user_agent, _raise_exceptions_for_gated_repo, _raise_exceptions_for_missing_entries, _raise_exceptions_for_connection_errors, _commit_hash, **deprecated_kwargs)[39m
[32m    477[39m [38;5;28;01mif[39;00m [38;5;28mlen[39m(full_filenames) == [32m1[39m:
[32m    478[39m     [38;5;66;03m# This is slightly better for only 1 file[39;00m
[32m--> [39m[32m479[39m     [43mhf_hub_download[49m[43m([49m
[32m    480[39m [43m        [49m[43mpath_or_repo_id[49m[43m,[49m
[32m    481[39m [43m        [49m[43mfilenames[49m[43m[[49m[32;43m0[39;49m[43m][49m[43m,[49m
[32m    482[39m [43m        [49m[43msubfolder[49m[43m=[49m[38;5;28;43;01mNone[39;49;00m[43m [49m[38;5;28;43;01mif[39;49;00m[43m [49m[38;5;28;43mlen[39;49m[43m([49m[43msubfolder[49m[43m)[49m[43m [49m[43m==[49m[43m [49m[32;43m0[39;49m[43m [49m[38;5;28;43;01melse[39;49;00m[43m [49m[43msubfolder[49m[43m,[49m
[32m    483[39m [43m        [49m[43mrepo_type[49m[43m=[49m[43mrepo_type[49m[43m,[49m
[32m    484[39m [43m        [49m[43mrevision[49m[43m=[49m[43mrevision[49m[43m,[49m
[32m    485[39m [43m        [49m[43mcache_dir[49m[43m=[49m[43mcache_dir[49m[43m,[49m
[32m    486[39m [43m        [49m[43muser_agent[49m[43m=[49m[43muser_agent[49m[43m,[49m
[32m    487[39m [43m        [49m[43mforce_download[49m[43m=[49m[43mforce_download[49m[43m,[49m
[32m    488[39m [43m        [49m[43mproxies[49m[43m=[49m[43mproxies[49m[43m,[49m
[32m    489[39m [43m        [49m[43mresume_download[49m[43m=[49m[43mresume_download[49m[43m,[49m
[32m    490[39m [43m        [49m[43mtoken[49m[43m=[49m[43mtoken[49m[43m,[49m
[32m    491[39m [43m        [49m[43mlocal_files_only[49m[43m=[49m[43mlocal_files_only[49m[43m,[49m
[32m    492[39m [43m    [49m[43m)[49m
[32m    493[39m [38;5;28;01melse[39;00m:

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py:114[39m, in [36mvalidate_hf_hub_args.<locals>._inner_fn[39m[34m(*args, **kwargs)[39m
[32m    112[39m     kwargs = smoothly_deprecate_use_auth_token(fn_name=fn.[34m__name__[39m, has_token=has_token, kwargs=kwargs)
[32m--> [39m[32m114[39m [38;5;28;01mreturn[39;00m [43mfn[49m[43m([49m[43m*[49m[43margs[49m[43m,[49m[43m [49m[43m*[49m[43m*[49m[43mkwargs[49m[43m)[49m

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/huggingface_hub/file_download.py:1007[39m, in [36mhf_hub_download[39m[34m(repo_id, filename, subfolder, repo_type, revision, library_name, library_version, cache_dir, local_dir, user_agent, force_download, proxies, etag_timeout, token, local_files_only, headers, endpoint, resume_download, force_filename, local_dir_use_symlinks)[39m
[32m   1006[39m [38;5;28;01melse[39;00m:
[32m-> [39m[32m1007[39m     [38;5;28;01mreturn[39;00m [43m_hf_hub_download_to_cache_dir[49m[43m([49m
[32m   1008[39m [43m        [49m[38;5;66;43;03m# Destination[39;49;00m
[32m   1009[39m [43m        [49m[43mcache_dir[49m[43m=[49m[43mcache_dir[49m[43m,[49m
[32m   1010[39m [43m        [49m[38;5;66;43;03m# File info[39;49;00m
[32m   1011[39m [43m        [49m[43mrepo_id[49m[43m=[49m[43mrepo_id[49m[43m,[49m
[32m   1012[39m [43m        [49m[43mfilename[49m[43m=[49m[43mfilename[49m[43m,[49m
[32m   1013[39m [43m        [49m[43mrepo_type[49m[43m=[49m[43mrepo_type[49m[43m,[49m
[32m   1014[39m [43m        [49m[43mrevision[49m[43m=[49m[43mrevision[49m[43m,[49m
[32m   1015[39m [43m        [49m[38;5;66;43;03m# HTTP info[39;49;00m
[32m   1016[39m [43m        [49m[43mendpoint[49m[43m=[49m[43mendpoint[49m[43m,[49m
[32m   1017[39m [43m        [49m[43metag_timeout[49m[43m=[49m[43metag_timeout[49m[43m,[49m
[32m   1018[39m [43m        [49m[43mheaders[49m[43m=[49m[43mhf_headers[49m[43m,[49m
[32m   1019[39m [43m        [49m[43mproxies[49m[43m=[49m[43mproxies[49m[43m,[49m
[32m   1020[39m [43m        [49m[43mtoken[49m[43m=[49m[43mtoken[49m[43m,[49m
[32m   1021[39m [43m        [49m[38;5;66;43;03m# Additional options[39;49;00m
[32m   1022[39m [43m        [49m[43mlocal_files_only[49m[43m=[49m[43mlocal_files_only[49m[43m,[49m
[32m   1023[39m [43m        [49m[43mforce_download[49m[43m=[49m[43mforce_download[49m[43m,[49m
[32m   1024[39m [43m    [49m[43m)[49m

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/huggingface_hub/file_download.py:1114[39m, in [36m_hf_hub_download_to_cache_dir[39m[34m(cache_dir, repo_id, filename, repo_type, revision, endpoint, etag_timeout, headers, proxies, token, local_files_only, force_download)[39m
[32m   1113[39m     [38;5;66;03m# Otherwise, raise appropriate error[39;00m
[32m-> [39m[32m1114[39m     [43m_raise_on_head_call_error[49m[43m([49m[43mhead_call_error[49m[43m,[49m[43m [49m[43mforce_download[49m[43m,[49m[43m [49m[43mlocal_files_only[49m[43m)[49m
[32m   1116[39m [38;5;66;03m# From now on, etag, commit_hash, url and size are not None.[39;00m

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/huggingface_hub/file_download.py:1655[39m, in [36m_raise_on_head_call_error[39m[34m(head_call_error, force_download, local_files_only)[39m
[32m   1650[39m [38;5;28;01melif[39;00m [38;5;28misinstance[39m(head_call_error, (RepositoryNotFoundError, GatedRepoError)) [38;5;129;01mor[39;00m (
[32m   1651[39m     [38;5;28misinstance[39m(head_call_error, HfHubHTTPError) [38;5;129;01mand[39;00m head_call_error.response.status_code == [32m401[39m
[32m   1652[39m ):
[32m   1653[39m     [38;5;66;03m# Repo not found or gated => let's raise the actual error[39;00m
[32m   1654[39m     [38;5;66;03m# Unauthorized => likely a token issue => let's raise the actual error[39;00m
[32m-> [39m[32m1655[39m     [38;5;28;01mraise[39;00m head_call_error
[32m   1656[39m [38;5;28;01melse[39;00m:
[32m   1657[39m     [38;5;66;03m# Otherwise: most likely a connection issue or Hub downtime => let's warn the user[39;00m

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/huggingface_hub/file_download.py:1543[39m, in [36m_get_metadata_or_catch_error[39m[34m(repo_id, filename, repo_type, revision, endpoint, proxies, etag_timeout, headers, token, local_files_only, relative_filename, storage_folder)[39m
[32m   1542[39m [38;5;28;01mtry[39;00m:
[32m-> [39m[32m1543[39m     metadata = [43mget_hf_file_metadata[49m[43m([49m
[32m   1544[39m [43m        [49m[43murl[49m[43m=[49m[43murl[49m[43m,[49m[43m [49m[43mproxies[49m[43m=[49m[43mproxies[49m[43m,[49m[43m [49m[43mtimeout[49m[43m=[49m[43metag_timeout[49m[43m,[49m[43m [49m[43mheaders[49m[43m=[49m[43mheaders[49m[43m,[49m[43m [49m[43mtoken[49m[43m=[49m[43mtoken[49m[43m,[49m[43m [49m[43mendpoint[49m[43m=[49m[43mendpoint[49m
[32m   1545[39m [43m    [49m[43m)[49m
[32m   1546[39m [38;5;28;01mexcept[39;00m EntryNotFoundError [38;5;28;01mas[39;00m http_error:

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py:114[39m, in [36mvalidate_hf_hub_args.<locals>._inner_fn[39m[34m(*args, **kwargs)[39m
[32m    112[39m     kwargs = smoothly_deprecate_use_auth_token(fn_name=fn.[34m__name__[39m, has_token=has_token, kwargs=kwargs)
[32m--> [39m[32m114[39m [38;5;28;01mreturn[39;00m [43mfn[49m[43m([49m[43m*[49m[43margs[49m[43m,[49m[43m [49m[43m*[49m[43m*[49m[43mkwargs[49m[43m)[49m

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/huggingface_hub/file_download.py:1460[39m, in [36mget_hf_file_metadata[39m[34m(url, token, proxies, timeout, library_name, library_version, user_agent, headers, endpoint)[39m
[32m   1459[39m [38;5;66;03m# Retrieve metadata[39;00m
[32m-> [39m[32m1460[39m r = [43m_request_wrapper[49m[43m([49m
[32m   1461[39m [43m    [49m[43mmethod[49m[43m=[49m[33;43m"[39;49m[33;43mHEAD[39;49m[33;43m"[39;49m[43m,[49m
[32m   1462[39m [43m    [49m[43murl[49m[43m=[49m[43murl[49m[43m,[49m
[32m   1463[39m [43m    [49m[43mheaders[49m[43m=[49m[43mhf_headers[49m[43m,[49m
[32m   1464[39m [43m    [49m[43mallow_redirects[49m[43m=[49m[38;5;28;43;01mFalse[39;49;00m[43m,[49m
[32m   1465[39m [43m    [49m[43mfollow_relative_redirects[49m[43m=[49m[38;5;28;43;01mTrue[39;49;00m[43m,[49m
[32m   1466[39m [43m    [49m[43mproxies[49m[43m=[49m[43mproxies[49m[43m,[49m
[32m   1467[39m [43m    [49m[43mtimeout[49m[43m=[49m[43mtimeout[49m[43m,[49m
[32m   1468[39m [43m[49m[43m)[49m
[32m   1469[39m hf_raise_for_status(r)

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/huggingface_hub/file_download.py:283[39m, in [36m_request_wrapper[39m[34m(method, url, follow_relative_redirects, **params)[39m
[32m    282[39m [38;5;28;01mif[39;00m follow_relative_redirects:
[32m--> [39m[32m283[39m     response = [43m_request_wrapper[49m[43m([49m
[32m    284[39m [43m        [49m[43mmethod[49m[43m=[49m[43mmethod[49m[43m,[49m
[32m    285[39m [43m        [49m[43murl[49m[43m=[49m[43murl[49m[43m,[49m
[32m    286[39m [43m        [49m[43mfollow_relative_redirects[49m[43m=[49m[38;5;28;43;01mFalse[39;49;00m[43m,[49m
[32m    287[39m [43m        [49m[43m*[49m[43m*[49m[43mparams[49m[43m,[49m
[32m    288[39m [43m    [49m[43m)[49m
[32m    290[39m     [38;5;66;03m# If redirection, we redirect only relative paths.[39;00m
[32m    291[39m     [38;5;66;03m# This is useful in case of a renamed repository.[39;00m

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/huggingface_hub/file_download.py:307[39m, in [36m_request_wrapper[39m[34m(method, url, follow_relative_redirects, **params)[39m
[32m    306[39m response = http_backoff(method=method, url=url, **params)
[32m--> [39m[32m307[39m [43mhf_raise_for_status[49m[43m([49m[43mresponse[49m[43m)[49m
[32m    308[39m [38;5;28;01mreturn[39;00m response

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/huggingface_hub/utils/_http.py:452[39m, in [36mhf_raise_for_status[39m[34m(response, endpoint_name)[39m
[32m    443[39m     message = (
[32m    444[39m         [33mf[39m[33m"[39m[38;5;132;01m{[39;00mresponse.status_code[38;5;132;01m}[39;00m[33m Client Error.[39m[33m"[39m
[32m    445[39m         + [33m"[39m[38;5;130;01m\n[39;00m[38;5;130;01m\n[39;00m[33m"[39m
[32m   (...)[39m[32m    450[39m         [33m"[39m[33m https://huggingface.co/docs/huggingface_hub/authentication[39m[33m"[39m
[32m    451[39m     )
[32m--> [39m[32m452[39m     [38;5;28;01mraise[39;00m _format(RepositoryNotFoundError, message, response) [38;5;28;01mfrom[39;00m[38;5;250m [39m[34;01me[39;00m
[32m    454[39m [38;5;28;01melif[39;00m response.status_code == [32m400[39m:

[31mRepositoryNotFoundError[39m: 404 Client Error. (Request ID: Root=1-69a0464a-3d918b940ce95ddd5adf24ff;3838f242-055f-4a88-9659-78ed7df57b0d)

Repository Not Found for url: https://huggingface.co/FernandoLpz/KaLM-ft-cov19en-hs/resolve/main/tokenizer_config.json.
Please make sure you specified the correct `repo_id` and `repo_type`.
If you are trying to access a private or gated repo, make sure you are authenticated. For more details, see https://huggingface.co/docs/huggingface_hub/authentication

The above exception was the direct cause of the following exception:

[31mOSError[39m                                   Traceback (most recent call last)
[36mCell[39m[36m [39m[32mIn[4][39m[32m, line 1[39m
[32m----> [39m[32m1[39m tokenizer = [43mAutoTokenizer[49m[43m.[49m[43mfrom_pretrained[49m[43m([49m[43mMODEL_NAME[49m[43m)[49m
[32m      2[39m [38;5;28;01mif[39;00m tokenizer.pad_token [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[32m      3[39m     tokenizer.pad_token = tokenizer.eos_token

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/transformers/models/auto/tokenization_auto.py:1089[39m, in [36mAutoTokenizer.from_pretrained[39m[34m(cls, pretrained_model_name_or_path, *inputs, **kwargs)[39m
[32m   1086[39m     [38;5;28;01mreturn[39;00m tokenizer_class.from_pretrained(pretrained_model_name_or_path, *inputs, **kwargs)
[32m   1088[39m [38;5;66;03m# Next, let's try to use the tokenizer_config file to get the tokenizer class.[39;00m
[32m-> [39m[32m1089[39m tokenizer_config = [43mget_tokenizer_config[49m[43m([49m[43mpretrained_model_name_or_path[49m[43m,[49m[43m [49m[43m*[49m[43m*[49m[43mkwargs[49m[43m)[49m
[32m   1090[39m [38;5;28;01mif[39;00m [33m"[39m[33m_commit_hash[39m[33m"[39m [38;5;129;01min[39;00m tokenizer_config:
[32m   1091[39m     kwargs[[33m"[39m[33m_commit_hash[39m[33m"[39m] = tokenizer_config[[33m"[39m[33m_commit_hash[39m[33m"[39m]

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/transformers/models/auto/tokenization_auto.py:921[39m, in [36mget_tokenizer_config[39m[34m(pretrained_model_name_or_path, cache_dir, force_download, resume_download, proxies, token, revision, local_files_only, subfolder, **kwargs)[39m
[32m    918[39m     token = use_auth_token
[32m    920[39m commit_hash = kwargs.get([33m"[39m[33m_commit_hash[39m[33m"[39m)
[32m--> [39m[32m921[39m resolved_config_file = [43mcached_file[49m[43m([49m
[32m    922[39m [43m    [49m[43mpretrained_model_name_or_path[49m[43m,[49m
[32m    923[39m [43m    [49m[43mTOKENIZER_CONFIG_FILE[49m[43m,[49m
[32m    924[39m [43m    [49m[43mcache_dir[49m[43m=[49m[43mcache_dir[49m[43m,[49m
[32m    925[39m [43m    [49m[43mforce_download[49m[43m=[49m[43mforce_download[49m[43m,[49m
[32m    926[39m [43m    [49m[43mresume_download[49m[43m=[49m[43mresume_download[49m[43m,[49m
[32m    927[39m [43m    [49m[43mproxies[49m[43m=[49m[43mproxies[49m[43m,[49m
[32m    928[39m [43m    [49m[43mtoken[49m[43m=[49m[43mtoken[49m[43m,[49m
[32m    929[39m [43m    [49m[43mrevision[49m[43m=[49m[43mrevision[49m[43m,[49m
[32m    930[39m [43m    [49m[43mlocal_files_only[49m[43m=[49m[43mlocal_files_only[49m[43m,[49m
[32m    931[39m [43m    [49m[43msubfolder[49m[43m=[49m[43msubfolder[49m[43m,[49m
[32m    932[39m [43m    [49m[43m_raise_exceptions_for_gated_repo[49m[43m=[49m[38;5;28;43;01mFalse[39;49;00m[43m,[49m
[32m    933[39m [43m    [49m[43m_raise_exceptions_for_missing_entries[49m[43m=[49m[38;5;28;43;01mFalse[39;49;00m[43m,[49m
[32m    934[39m [43m    [49m[43m_raise_exceptions_for_connection_errors[49m[43m=[49m[38;5;28;43;01mFalse[39;49;00m[43m,[49m
[32m    935[39m [43m    [49m[43m_commit_hash[49m[43m=[49m[43mcommit_hash[49m[43m,[49m
[32m    936[39m [43m[49m[43m)[49m
[32m    937[39m [38;5;28;01mif[39;00m resolved_config_file [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[32m    938[39m     logger.info([33m"[39m[33mCould not locate the tokenizer configuration file, will try to use the model config instead.[39m[33m"[39m)

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/transformers/utils/hub.py:322[39m, in [36mcached_file[39m[34m(path_or_repo_id, filename, **kwargs)[39m
[32m    264[39m [38;5;28;01mdef[39;00m[38;5;250m [39m[34mcached_file[39m(
[32m    265[39m     path_or_repo_id: Union[[38;5;28mstr[39m, os.PathLike],
[32m    266[39m     filename: [38;5;28mstr[39m,
[32m    267[39m     **kwargs,
[32m    268[39m ) -> Optional[[38;5;28mstr[39m]:
[32m    269[39m [38;5;250m    [39m[33;03m"""[39;00m
[32m    270[39m [33;03m    Tries to locate a file in a local folder and repo, downloads and cache it if necessary.[39;00m
[32m    271[39m 
[32m   (...)[39m[32m    320[39m [33;03m    ```[39;00m
[32m    321[39m [33;03m    """[39;00m
[32m--> [39m[32m322[39m     file = [43mcached_files[49m[43m([49m[43mpath_or_repo_id[49m[43m=[49m[43mpath_or_repo_id[49m[43m,[49m[43m [49m[43mfilenames[49m[43m=[49m[43m[[49m[43mfilename[49m[43m][49m[43m,[49m[43m [49m[43m*[49m[43m*[49m[43mkwargs[49m[43m)[49m
[32m    323[39m     file = file[[32m0[39m] [38;5;28;01mif[39;00m file [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m [38;5;28;01melse[39;00m file
[32m    324[39m     [38;5;28;01mreturn[39;00m file

[36mFile [39m[32m~/.conda/envs/RFA2526pt/lib/python3.12/site-packages/transformers/utils/hub.py:511[39m, in [36mcached_files[39m[34m(path_or_repo_id, filenames, cache_dir, force_download, resume_download, proxies, token, revision, local_files_only, subfolder, repo_type, user_agent, _raise_exceptions_for_gated_repo, _raise_exceptions_for_missing_entries, _raise_exceptions_for_connection_errors, _commit_hash, **deprecated_kwargs)[39m
[32m    508[39m [38;5;28;01mexcept[39;00m [38;5;167;01mException[39;00m [38;5;28;01mas[39;00m e:
[32m    509[39m     [38;5;66;03m# We cannot recover from them[39;00m
[32m    510[39m     [38;5;28;01mif[39;00m [38;5;28misinstance[39m(e, RepositoryNotFoundError) [38;5;129;01mand[39;00m [38;5;129;01mnot[39;00m [38;5;28misinstance[39m(e, GatedRepoError):
[32m--> [39m[32m511[39m         [38;5;28;01mraise[39;00m [38;5;167;01mOSError[39;00m(
[32m    512[39m             [33mf[39m[33m"[39m[38;5;132;01m{[39;00mpath_or_repo_id[38;5;132;01m}[39;00m[33m is not a local folder and is not a valid model identifier [39m[33m"[39m
[32m    513[39m             [33m"[39m[33mlisted on [39m[33m'[39m[33mhttps://huggingface.co/models[39m[33m'[39m[38;5;130;01m\n[39;00m[33mIf this is a private repository, make sure to pass a token [39m[33m"[39m
[32m    514[39m             [33m"[39m[33mhaving permission to this repo either by logging in with `hf auth login` or by passing [39m[33m"[39m
[32m    515[39m             [33m"[39m[33m`token=<your_token>`[39m[33m"[39m
[32m    516[39m         ) [38;5;28;01mfrom[39;00m[38;5;250m [39m[34;01me[39;00m
[32m    517[39m     [38;5;28;01melif[39;00m [38;5;28misinstance[39m(e, RevisionNotFoundError):
[32m    518[39m         [38;5;28;01mraise[39;00m [38;5;167;01mOSError[39;00m(
[32m    519[39m             [33mf[39m[33m"[39m[38;5;132;01m{[39;00mrevision[38;5;132;01m}[39;00m[33m is not a valid git identifier (branch name, tag name or commit id) that exists [39m[33m"[39m
[32m    520[39m             [33m"[39m[33mfor this model name. Check the model page at [39m[33m"[39m
[32m    521[39m             [33mf[39m[33m"[39m[33m'[39m[33mhttps://huggingface.co/[39m[38;5;132;01m{[39;00mpath_or_repo_id[38;5;132;01m}[39;00m[33m'[39m[33m for available revisions.[39m[33m"[39m
[32m    522[39m         ) [38;5;28;01mfrom[39;00m[38;5;250m [39m[34;01me[39;00m

[31mOSError[39m: FernandoLpz/KaLM-ft-cov19en-hs is not a local folder and is not a valid model identifier listed on 'https://huggingface.co/models'
If this is a private repository, make sure to pass a token having permission to this repo either by logging in with `hf auth login` or by passing `token=<your_token>`

Memory cleaned
[W226 14:10:38.425708586 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
WARNING: 06_KaLM_ft_text_clean.ipynb execution failed, continuing with next notebook...

==========================================
Starting execution of: 07_Ministral3_8B_inference_tweet.ipynb
==========================================
Error occurred. Notebook saved to: entregables/07_Ministral3_8B_inference_tweet_error.ipynb
Error: An error occurred while executing the following cell:
------------------
import os
import torch
import pandas as pd
import numpy as np

from transformers import MistralCommonBackend, Mistral3ForConditionalGeneration, FineGrainedFP8Config
from sklearn.metrics import (
    accuracy_score,
    precision_recall_fscore_support
)

from pyevall.evaluation import PyEvALLEvaluation
from pyevall.metrics.metricfactory import MetricFactory
------------------


[31m---------------------------------------------------------------------------[39m
[31mImportError[39m                               Traceback (most recent call last)
[36mCell[39m[36m [39m[32mIn[1][39m[32m, line 6[39m
[32m      3[39m [38;5;28;01mimport[39;00m[38;5;250m [39m[34;01mpandas[39;00m[38;5;250m [39m[38;5;28;01mas[39;00m[38;5;250m [39m[34;01mpd[39;00m
[32m      4[39m [38;5;28;01mimport[39;00m[38;5;250m [39m[34;01mnumpy[39;00m[38;5;250m [39m[38;5;28;01mas[39;00m[38;5;250m [39m[34;01mnp[39;00m
[32m----> [39m[32m6[39m [38;5;28;01mfrom[39;00m[38;5;250m [39m[34;01mtransformers[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m MistralCommonBackend, Mistral3ForConditionalGeneration, FineGrainedFP8Config
[32m      7[39m [38;5;28;01mfrom[39;00m[38;5;250m [39m[34;01msklearn[39;00m[34;01m.[39;00m[34;01mmetrics[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m (
[32m      8[39m     accuracy_score,
[32m      9[39m     precision_recall_fscore_support
[32m     10[39m )
[32m     12[39m [38;5;28;01mfrom[39;00m[38;5;250m [39m[34;01mpyevall[39;00m[34;01m.[39;00m[34;01mevaluation[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m PyEvALLEvaluation

[31mImportError[39m: cannot import name 'MistralCommonBackend' from 'transformers' (/home/alumno.upv.es/scheng1/.conda/envs/RFA2526pt/lib/python3.12/site-packages/transformers/__init__.py)

Memory cleaned
[W226 14:10:45.460354535 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
WARNING: 07_Ministral3_8B_inference_tweet.ipynb execution failed, continuing with next notebook...

==========================================
Starting execution of: 08_Ministral3_8B_only_ft.ipynb
==========================================
Error occurred. Notebook saved to: entregables/08_Ministral3_8B_only_ft_error.ipynb
Error: An error occurred while executing the following cell:
------------------
import os
import torch
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from torch.utils.data import Dataset, DataLoader

from transformers import (
    Mistral3ForConditionalGeneration,
    FineGrainedFP8Config,
    MistralCommonBackend,
    get_cosine_schedule_with_warmup,
)
from peft import LoraConfig, get_peft_model, TaskType
------------------


[31m---------------------------------------------------------------------------[39m
[31mImportError[39m                               Traceback (most recent call last)
[36mCell[39m[36m [39m[32mIn[1][39m[32m, line 8[39m
[32m      5[39m [38;5;28;01mimport[39;00m[38;5;250m [39m[34;01mmatplotlib[39;00m[34;01m.[39;00m[34;01mpyplot[39;00m[38;5;250m [39m[38;5;28;01mas[39;00m[38;5;250m [39m[34;01mplt[39;00m
[32m      6[39m [38;5;28;01mfrom[39;00m[38;5;250m [39m[34;01mtorch[39;00m[34;01m.[39;00m[34;01mutils[39;00m[34;01m.[39;00m[34;01mdata[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m Dataset, DataLoader
[32m----> [39m[32m8[39m [38;5;28;01mfrom[39;00m[38;5;250m [39m[34;01mtransformers[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m (
[32m      9[39m     Mistral3ForConditionalGeneration,
[32m     10[39m     FineGrainedFP8Config,
[32m     11[39m     MistralCommonBackend,
[32m     12[39m     get_cosine_schedule_with_warmup,
[32m     13[39m )
[32m     14[39m [38;5;28;01mfrom[39;00m[38;5;250m [39m[34;01mpeft[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m LoraConfig, get_peft_model, TaskType

[31mImportError[39m: cannot import name 'MistralCommonBackend' from 'transformers' (/home/alumno.upv.es/scheng1/.conda/envs/RFA2526pt/lib/python3.12/site-packages/transformers/__init__.py)

Memory cleaned
[W226 14:10:53.195520122 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
WARNING: 08_Ministral3_8B_only_ft.ipynb execution failed, continuing with next notebook...

==========================================
Starting execution of: 09_Ministral3_8B_inference_ft.ipynb
==========================================
Error occurred. Notebook saved to: entregables/09_Ministral3_8B_inference_ft_error.ipynb
Error: An error occurred while executing the following cell:
------------------
import os
import torch
import pandas as pd
import numpy as np

from transformers import Mistral3ForConditionalGeneration, FineGrainedFP8Config, MistralCommonBackend
from peft import PeftModel

from sklearn.metrics import accuracy_score, precision_recall_fscore_support

from pyevall.evaluation import PyEvALLEvaluation
from pyevall.metrics.metricfactory import MetricFactory
------------------


[31m---------------------------------------------------------------------------[39m
[31mImportError[39m                               Traceback (most recent call last)
[36mCell[39m[36m [39m[32mIn[1][39m[32m, line 6[39m
[32m      3[39m [38;5;28;01mimport[39;00m[38;5;250m [39m[34;01mpandas[39;00m[38;5;250m [39m[38;5;28;01mas[39;00m[38;5;250m [39m[34;01mpd[39;00m
[32m      4[39m [38;5;28;01mimport[39;00m[38;5;250m [39m[34;01mnumpy[39;00m[38;5;250m [39m[38;5;28;01mas[39;00m[38;5;250m [39m[34;01mnp[39;00m
[32m----> [39m[32m6[39m [38;5;28;01mfrom[39;00m[38;5;250m [39m[34;01mtransformers[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m Mistral3ForConditionalGeneration, FineGrainedFP8Config, MistralCommonBackend
[32m      7[39m [38;5;28;01mfrom[39;00m[38;5;250m [39m[34;01mpeft[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m PeftModel
[32m      9[39m [38;5;28;01mfrom[39;00m[38;5;250m [39m[34;01msklearn[39;00m[34;01m.[39;00m[34;01mmetrics[39;00m[38;5;250m [39m[38;5;28;01mimport[39;00m accuracy_score, precision_recall_fscore_support

[31mImportError[39m: cannot import name 'MistralCommonBackend' from 'transformers' (/home/alumno.upv.es/scheng1/.conda/envs/RFA2526pt/lib/python3.12/site-packages/transformers/__init__.py)

Memory cleaned
[W226 14:11:00.249171652 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
WARNING: 09_Ministral3_8B_inference_ft.ipynb execution failed, continuing with next notebook...

==========================================
All notebooks processed!
==========================================
